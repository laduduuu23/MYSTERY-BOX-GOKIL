<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width,initial-scale=1.0">
  <title>MYSTERY BOX SLOTGOKIL</title>
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@800&display=swap" rel="stylesheet">
  <style>
    :root {
      --emerald: #00e6a0;
      --gold: #ffd700;
      --gold-shimmer: #fffbe6;
      --casino-bg: url('https://images.unsplash.com/photo-1511512578047-dfb367046420');
      --box-size: min(120px, 22vw);
      --box-gap: 2vw;
      --font-main: 'Montserrat', Arial, sans-serif;
    }
    html, body {
      height: 100%;
      margin: 0;
      padding: 0;
      font-family: var(--font-main);
      min-height: 100vh;
      background: var(--casino-bg) center/cover no-repeat fixed;
      position: relative;
      overflow-x: hidden;
    }
    body::before {
      /* Gradient overlay for readability */
      content: "";
      position: fixed;
      z-index: 0;
      inset: 0;
      pointer-events: none;
      background: linear-gradient(135deg, #181c2aee 0%, #181c2a99 40%, #00e6a033 80%, #ffd70022 100%);
      opacity: 0.92;
    }
    /* Subtle floating particles */
    .particle {
      position: fixed;
      border-radius: 50%;
      pointer-events: none;
      opacity: 0.13;
      z-index: 1;
      animation: float 14s linear infinite;
      background: radial-gradient(circle, #fffbe6 0%, #ffd700 60%, transparent 100%);
    }
    @keyframes float {
      0% { transform: translateY(0) scale(1);}
      100% { transform: translateY(-100vh) scale(1.2);}
    }
    /* Top right icons */
    .corner-icons {
      position: fixed;
      top: 28px;
      right: 28px;
      z-index: 20;
      display: flex;
      gap: 16px;
    }
    .corner-icon {
      width: 44px;
      height: 44px;
      display: flex;
      align-items: center;
      justify-content: center;
      border-radius: 50%;
      background: rgba(24,28,42,0.7);
      box-shadow: 0 0 8px 2px #00e6a044;
      transition: box-shadow .18s, transform .18s;
      cursor: pointer;
      border: 2px solid #ffd70022;
    }
    .corner-icon:hover {
      box-shadow: 0 0 16px 4px #ffd70066, 0 0 8px 2px #00e6a066;
      transform: scale(1.09);
    }
    /* Main container */
    .main-center {
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      flex-direction: column;
      z-index: 3;
      position: relative;
      padding: 32px 0;
    }
    /* Step 1: Form */
    .form-panel {
      background: rgba(24,28,42,0.55);
      border-radius: 28px;
      box-shadow: 0 0 16px 2px #00e6a044;
      padding: 44px 32px 36px 32px;
      max-width: 400px;
      width: 100%;
      margin: 0 auto;
      display: flex;
      flex-direction: column;
      align-items: center;
      position: relative;
      border: 2.5px solid #00e6a0;
      box-sizing: border-box;
      backdrop-filter: blur(10px);
      animation: fadeInUp .7s cubic-bezier(.4,2,.3,1);
      filter: drop-shadow(0 0 16px #00e6a033);
    }
    @keyframes fadeInUp {
      0% { opacity: 0; transform: translateY(40px);}
      100% { opacity: 1; transform: translateY(0);}
    }
    .form-title {
      font-family: var(--font-main);
      font-size: 2.1rem;
      font-weight: 800;
      letter-spacing: 1.5px;
      text-align: center;
      margin-bottom: 30px;
      background: linear-gradient(90deg, #00e6a0 0%, #ffd700 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      text-shadow: 0 0 6px #00e6a0, 0 0 2px #ffd700;
    }
    .form-group {
      width: 100%;
      margin-bottom: 22px;
      display: flex;
      flex-direction: column;
      align-items: flex-start;
    }
    .form-label {
      font-size: 1.08rem;
      font-weight: 700;
      color: #fff;
      margin-bottom: 7px;
      text-shadow: 0 0 2px #00e6a0;
    }
    .form-input {
      width: 100%;
      padding: 14px 10px;
      border-radius: 14px;
      border: 2px solid #00e6a0;
      background: #181c2aee;
      color: #fff;
      font-size: 1.08rem;
      font-weight: 700;
      box-shadow: inset 0 2px 12px 0 #003a2b99;
      outline: none;
      transition: border-color .18s, box-shadow .18s;
      margin-bottom: 0;
    }
    .form-input::placeholder {
      color: #bfc9c9;
      font-weight: 700;
      opacity: 1;
      letter-spacing: 1px;
    }
    .form-input:focus {
      border-color: #ffd700;
      box-shadow: 0 0 12px 2px #ffd70044;
      background: #232a3a;
      transition: box-shadow .18s, border-color .18s;
    }
    .btn-main {
      width: 100%;
      padding: 15px 0;
      border-radius: 14px;
      background: linear-gradient(90deg, #00e6a0 0%, #ffd700 100%);
      color: #fff;
      font-size: 1.13rem;
      font-weight: 800;
      text-transform: uppercase;
      letter-spacing: 2px;
      border: none;
      box-shadow: 0 0 16px 4px #00e6a044;
      cursor: pointer;
      transition: box-shadow .18s, transform .18s;
      margin-top: 10px;
      outline: none;
    }
    .btn-main:hover, .btn-main:focus {
      box-shadow: 0 0 32px 8px #ffd70044, 0 0 8px 2px #00e6a044;
      transform: scale(1.04);
      color: #ffd700;
      background: linear-gradient(90deg, #ffd700 0%, #00e6a0 100%);
    }
    /* Step 2: Grid */
    .game-panel {
      background: rgba(24,28,42,0.55);
      border-radius: 28px;
      box-shadow: 0 0 16px 2px #00e6a044;
      padding: 36px 20px 28px 20px;
      max-width: 500px;
      width: 100%;
      margin: 0 auto;
      display: flex;
      flex-direction: column;
      align-items: center;
      position: relative;
      border: 2.5px solid #ffd70088;
      box-sizing: border-box;
      backdrop-filter: blur(10px);
      animation: fadeInUp .7s cubic-bezier(.4,2,.3,1);
      filter: drop-shadow(0 0 16px #ffd70022);
    }
    .prize-list-btn {
      display: inline-block;
      margin-bottom: 18px;
      padding: 10px 24px;
      font-size: 1.05rem;
      font-weight: 800;
      border-radius: 12px;
      background: linear-gradient(90deg, #ffd700 0%, #00e6a0 100%);
      color: #fff;
      box-shadow: 0 0 8px 2px #ffd70022;
      border: none;
      cursor: pointer;
      transition: box-shadow .18s, transform .18s;
      outline: none;
      text-shadow: 0 0 2px #00e6a0;
    }
    .prize-list-btn:hover {
      box-shadow: 0 0 16px 4px #00e6a044, 0 0 8px 2px #ffd70044;
      color: #ffd700;
      transform: scale(1.03);
    }
    .grid {
      display: grid;
      grid-template-columns: repeat(3, var(--box-size));
      grid-template-rows: repeat(3, var(--box-size));
      gap: var(--box-gap);
      margin: 0 auto 18px auto;
      justify-content: center;
      align-items: center;
      z-index: 2;
      position: relative;
    }
    .box {
      width: var(--box-size);
      height: var(--box-size);
      background: linear-gradient(135deg, #00e6a0 0%, #ffd700 100%);
      border-radius: 12px;
      box-shadow: 0 0 12px 2px #00e6a044;
      border: 2.5px solid #ffd70044;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 2.1rem;
      font-weight: 900;
      color: #fff;
      cursor: pointer;
      position: relative;
      overflow: hidden;
      transition: box-shadow .18s, transform .18s, filter .18s;
      filter: drop-shadow(0 0 8px #ffd70022);
      user-select: none;
      outline: none;
      z-index: 2;
      animation: boxPop .7s cubic-bezier(.4,2,.3,1);
    }
    @keyframes boxPop {
      0% { opacity: 0; transform: scale(0.7);}
      100% { opacity: 1; transform: scale(1);}
    }
    .box .mystery-icon, .box .prize-icon {
      width: 44px;
      height: 44px;
      display: block;
      margin: 0 auto;
      filter: drop-shadow(0 0 8px #ffd70044);
      transition: filter .2s;
    }
    .box .prize-icon { display: none; }
    .box.opened .prize-icon { display: block; }
    .box.opened .mystery-icon { display: none; }
    .box:hover:not(.disabled):not(.opened) {
      box-shadow: 0 0 24px 6px #ffd70044, 0 0 12px 2px #00e6a044;
      transform: scale(1.05);
      filter: brightness(1.07);
    }
    .box.opened {
      animation: boxBurst .6s cubic-bezier(.4,2,.3,1);
      box-shadow: 0 0 32px 10px #ffd70044, 0 0 16px 4px #00e6a044;
      border-color: #ffd700;
      filter: brightness(1.13);
      z-index: 10;
    }
    @keyframes boxBurst {
      0% { transform: scale(1); box-shadow: 0 0 12px 2px #ffd70044;}
      60% { transform: scale(1.12); box-shadow: 0 0 32px 10px #ffd70044;}
      100% { transform: scale(1.05); box-shadow: 0 0 24px 6px #ffd70044;}
    }
    .box.disabled {
      pointer-events: none;
      opacity: 0.5;
      filter: grayscale(0.5) blur(1px);
    }
    .box.selected {
      border: 4px solid #00e6a0;
      box-shadow: 0 0 40px 16px #00e6a0cc, 0 0 24px 8px #ffd700cc;
      background: linear-gradient(135deg, #00e6a0 0%, #ffd700 100%, #fffbe6 100%);
      filter: brightness(1.35) drop-shadow(0 0 16px #00e6a0cc);
      z-index: 30;
    }
    .box .shine {
      position: absolute;
      top: -60%;
      left: -60%;
      width: 220%;
      height: 220%;
      background: linear-gradient(120deg, transparent 60%, #fffbe644 80%, transparent 100%);
      opacity: 0;
      pointer-events: none;
      z-index: 3;
      animation: shineAnim .6s cubic-bezier(.4,2,.3,1) forwards;
    }
    @keyframes shineAnim {
      0% { opacity: 0; }
      40% { opacity: 1; }
      100% { opacity: 0; }
    }
    .box .burst {
      position: absolute;
      left: 50%; top: 50%;
      width: 70px; height: 70px;
      pointer-events: none;
      transform: translate(-50%,-50%);
      opacity: 0.8;
      z-index: 4;
      animation: burst-burst .7s cubic-bezier(.4,2,.3,1) forwards;
    }
    @keyframes burst-burst {
      0% { opacity: 0; transform: translate(-50%,-50%) scale(0.5);}
      60% { opacity: 1; transform: translate(-50%,-50%) scale(1.2);}
      100% { opacity: 0; transform: translate(-50%,-50%) scale(1);}
    }
    /* Win Popup */
    .win-popup-bg {
      position: fixed;
      inset: 0;
      background: rgba(24,28,42,0.92);
      z-index: 100;
      display: flex;
      align-items: center;
      justify-content: center;
      animation: fadeIn .3s;
    }
    @keyframes fadeIn {
      0% { opacity: 0;}
      100% { opacity: 1;}
    }
    .win-popup {
      background: linear-gradient(135deg, #232a3a 0%, #ffd700 100%);
      border-radius: 24px;
      box-shadow: 0 0 32px 8px #ffd70044, 0 0 16px 4px #00e6a044;
      padding: 38px 24px 30px 24px;
      min-width: 280px;
      max-width: 90vw;
      text-align: center;
      position: relative;
      border: 2.5px solid #ffd700;
      animation: popupScale .5s cubic-bezier(.4,2,.3,1);
      filter: drop-shadow(0 0 16px #ffd70033);
    }
    @keyframes popupScale {
      0% { transform: scale(0.7); opacity: 0;}
      80% { transform: scale(1.08);}
      100% { transform: scale(1); opacity: 1;}
    }
    .win-popup .prize-icon {
      width: 60px;
      height: 60px;
      margin-bottom: 14px;
      display: inline-block;
      filter: drop-shadow(0 0 8px #ffd70044);
    }
    .win-popup .win-title {
      font-size: 1.7rem;
      font-weight: 900;
      background: linear-gradient(90deg, #ffd700 0%, #00e6a0 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      text-shadow: 0 0 8px #ffd700, 0 0 2px #00e6a0;
      -webkit-text-stroke: 1.5px #ffd700;
      margin-bottom: 12px;
      letter-spacing: 1.5px;
    }
    .win-popup .win-prize {
      font-size: 1.3rem;
      font-weight: 800;
      color: #ffd700;
      text-shadow: 0 0 8px #00e6a0, 0 0 2px #fff;
      margin-bottom: 24px;
      letter-spacing: 1px;
    }
    .btn-claim {
      display: inline-block;
      padding: 18px 48px;
      border-radius: 18px;
      background: linear-gradient(90deg, #ffd700 0%, #00e6a0 100%);
      color: #fff;
      font-size: 1.2rem;
      font-weight: 900;
      text-transform: uppercase;
      letter-spacing: 2px;
      border: none;
      box-shadow: 0 0 32px 8px #ffd700, 0 0 16px 4px #00e6a0;
      cursor: pointer;
      transition: box-shadow .2s, transform .2s;
      outline: none;
      margin-top: 12px;
      text-shadow: 0 0 4px #00e6a0;
    }
    .btn-claim:hover {
      box-shadow: 0 0 64px 16px #ffd700, 0 0 32px 8px #00e6a0;
      color: #ffd700;
      transform: scale(1.04);
    }
    /* Prize Modal & Modal History */
    .modal-bg, .modal-history-bg {
      position: fixed;
      inset: 0;
      background: rgba(24,28,42,0.92);
      z-index: 90;
      display: flex;
      align-items: center;
      justify-content: center;
      animation: fadeIn .3s;
    }
    .modal, .modal-history {
      background: linear-gradient(135deg, #181c2a 0%, #232a3a 100%);
      border-radius: 20px;
      box-shadow: 0 0 32px 8px #ffd70022, 0 0 16px 4px #00e6a022;
      padding: 32px 18px 24px 18px;
      min-width: 320px;
      max-width: 96vw;
      text-align: center;
      position: relative;
      border: 2.5px solid #ffd700;
      animation: popupScale .5s cubic-bezier(.4,2,.3,1);
      filter: drop-shadow(0 0 16px #ffd70022);
    }
    .modal-title {
      font-size: 1.25rem;
      font-weight: 900;
      background: linear-gradient(90deg, #2d254a 0%, #181c2a 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      text-shadow: 0 0 6px #ffd700, 0 0 2px #00e6a0;
      -webkit-text-stroke: 1px #ffd70044;
      margin-bottom: 8px;
      letter-spacing: 1.1px;
    }
    .modal-table {
      width: 100%;
      border-collapse: separate;
      border-spacing: 0;
      margin: 0 auto 18px auto;
      background: none;
      box-shadow: 0 0 8px 2px #ffd70022 inset;
      border-radius: 10px;
      overflow: hidden;
    }
    .modal-table th {
      background: linear-gradient(90deg, #2d254a 0%, #181c2a 100%);
      color: #ffd700;
      font-size: 1.08rem;
      font-weight: 800;
      padding: 10px 0;
      border-top-left-radius: 10px;
      border-top-right-radius: 10px;
      border-bottom: 2px solid #ffd70044;
      letter-spacing: 1px;
    }
    .modal-table td {
      font-size: 1.08rem;
      font-weight: 700;
      color: #fff;
      padding: 10px 0;
      border-bottom: 1px solid #ffd70022;
      background: none;
    }
    .modal-table tr:last-child td {
      border-bottom: none;
    }
    .modal-table .prize-amount {
      color: #ffd700;
      font-size: 1.13rem;
      font-weight: 900;
      letter-spacing: 1px;
    }
    .modal-table .prize-label {
      font-size: 1.05rem;
      font-weight: 800;
      color: #00e6a0;
      letter-spacing: 1px;
    }
    .btn-close-modal, .btn-close-history {
      display: inline-block;
      padding: 13px 36px;
      border-radius: 14px;
      background: linear-gradient(90deg, #00e6a0 0%, #ffd700 100%);
      color: #fff;
      font-size: 1.08rem;
      font-weight: 900;
      text-transform: uppercase;
      letter-spacing: 2px;
      border: none;
      box-shadow: 0 0 16px 4px #00e6a044;
      cursor: pointer;
      transition: box-shadow .18s, transform .18s;
      outline: none;
      margin-top: 10px;
      text-shadow: 0 0 2px #ffd700;
    }
    .btn-close-modal:hover, .btn-close-history:hover {
      box-shadow: 0 0 32px 8px #ffd70044, 0 0 16px 4px #00e6a044;
      color: #ffd700;
      transform: scale(1.04);
    }
    /* Modal History */
    .modal-history-title {
      font-size: 1.18rem;
      font-weight: 900;
      color: #ffd700;
      margin-bottom: 12px;
      letter-spacing: 1px;
      text-shadow: 0 0 4px #00e6a0;
    }
    .modal-history-row {
      margin-bottom: 8px;
      display: flex;
      flex-wrap: wrap;
      gap: 8px 18px;
      justify-content: center;
    }
    .modal-history-label {
      font-weight: 700;
      color: #00e6a0;
      min-width: 90px;
      display: inline-block;
    }
    .modal-history-value {
      font-weight: 800;
      color: #fff;
      display: inline-block;
    }
    .modal-history-prize {
      color: #ffd700;
      font-weight: 900;
      font-size: 1.13rem;
      margin-left: 4px;
    }
    .btn-show-history {
      display: inline-block;
      margin: 24px auto 0 auto;
      padding: 12px 32px;
      border-radius: 14px;
      background: linear-gradient(90deg, #00e6a0 0%, #ffd700 100%);
      color: #fff;
      font-size: 1.08rem;
      font-weight: 900;
      text-transform: uppercase;
      letter-spacing: 2px;
      border: none;
      box-shadow: 0 0 12px 2px #00e6a044;
      cursor: pointer;
      transition: box-shadow .18s, transform .18s;
      outline: none;
      text-shadow: 0 0 2px #ffd700;
      display: none;
    }
    .btn-show-history.active { display: block; }
    .btn-show-history:hover {
      box-shadow: 0 0 24px 6px #ffd70044, 0 0 8px 2px #00e6a044;
      color: #ffd700;
      transform: scale(1.03);
    }
    /* Responsive */
    @media (max-width: 700px) {
      .form-panel, .game-panel, .modal, .win-popup, .modal-history {
        padding: 10px 2vw 8px 2vw;
        min-width: unset;
        border-radius: 16px;
        box-shadow: 0 0 8px 2px #00e6a044;
        font-size: 0.98rem;
        animation: fadeInUp .7s cubic-bezier(.4,2,.3,1);
      }
      .form-title {
        font-size: 1.3rem;
        margin-bottom: 18px;
      }
      .grid {
        --box-size: min(60px, 24vw);
        gap: 2vw;
        margin-bottom: 10px;
      }
      .box {
        font-size: 1.2rem;
        border-radius: 8px;
      }
      .corner-icons {
        top: 8px;
        right: 4px;
        gap: 8px;
      }
      .btn-main, .btn-show-history, .prize-list-btn, .btn-close-modal, .btn-close-history {
        font-size: 0.98rem;
        padding: 10px 0;
        border-radius: 10px;
      }
      .win-popup .prize-icon {
        width: 40px;
        height: 40px;
        margin-bottom: 8px;
      }
      .win-popup .win-title {
        font-size: 1.1rem;
        margin-bottom: 8px;
      }
      .win-popup .win-prize {
        font-size: 1rem;
        margin-bottom: 12px;
      }
      .btn-claim {
        font-size: 1rem;
        padding: 12px 24px;
        border-radius: 12px;
        margin-top: 8px;
      }
      .modal-table th, .modal-table td {
        font-size: 0.95rem;
        padding: 7px 0;
      }
      .modal-title {
        font-size: 1rem;
        margin-bottom: 6px;
      }
      .modal-history-title {
        font-size: 1rem;
        margin-bottom: 8px;
      }
      .modal-history-label, .modal-history-value, .modal-history-prize {
        font-size: 0.95rem;
      }
    }
    @media (max-width: 480px) {
      .form-panel, .game-panel, .modal, .win-popup, .modal-history {
        padding: 6px 1vw 4px 1vw;
        border-radius: 10px;
      }
      .form-title {
        font-size: 1.1rem;
        margin-bottom: 12px;
      }
      .grid {
        --box-size: min(44px, 22vw);
        gap: 1vw;
        margin-bottom: 6px;
      }
      .box {
        font-size: 0.9rem;
        border-radius: 6px;
      }
      .corner-icons {
        top: 2px;
        right: 1px;
        gap: 4px;
      }
      .btn-main, .btn-show-history, .prize-list-btn, .btn-close-modal, .btn-close-history {
        font-size: 0.9rem;
        padding: 7px 0;
        border-radius: 8px;
      }
      .win-popup .prize-icon {
        width: 28px;
        height: 28px;
        margin-bottom: 4px;
      }
      .win-popup .win-title {
        font-size: 0.9rem;
        margin-bottom: 4px;
      }
      .win-popup .win-prize {
        font-size: 0.8rem;
        margin-bottom: 8px;
      }
      .btn-claim {
        font-size: 0.9rem;
        padding: 8px 16px;
        border-radius: 8px;
        margin-top: 4px;
      }
      .modal-table th, .modal-table td {
        font-size: 0.85rem;
        padding: 5px 0;
      }
      .modal-title {
        font-size: 0.85rem;
        margin-bottom: 4px;
      }
      .modal-history-title {
        font-size: 0.85rem;
        margin-bottom: 4px;
      }
      .modal-history-label, .modal-history-value, .modal-history-prize {
        font-size: 0.85rem;
      }
    }
  </style>
</head>
<body>
  <!-- Floating Particles -->
  <script>
    for(let i=0;i<12;i++){
      const p=document.createElement('div');
      p.className='particle';
      p.style.width=p.style.height=(Math.random()*12+8)+'px';
      p.style.left=(Math.random()*100)+'vw';
      p.style.top=(Math.random()*100)+'vh';
      p.style.background=`radial-gradient(circle, #${['ffd700','00e6a0','fffbe6'][Math.floor(Math.random()*3)]} 0%, transparent 80%)`;
      p.style.animationDuration=(Math.random()*8+8)+'s';
      p.style.opacity=Math.random()*0.2+0.12;
      document.body.appendChild(p);
    }
  </script>
  <!-- Top Right Social Icons -->
  <div class="corner-icons">
    <a href="https://klikblg.com/wa-sg
" target="_blank" class="corner-icon" title="WhatsApp">
      <!-- WhatsApp SVG -->
      <svg width="26" height="26" viewBox="0 0 32 32" fill="none">
        <circle cx="16" cy="16" r="16" fill="#25D366"/>
        <path d="M24.5 21.5c-1.1.5-2.3.8-3.5.8-4.4 0-8-3.6-8-8 0-1.2.3-2.4.8-3.5l-2.3-2.3C9.1 9.7 8 12.7 8 16c0 5.5 4.5 10 10 10 3.3 0 6.3-1.1 8.5-3l-2.3-2.3z" fill="#fff"/>
        <path d="M16 8c4.4 0 8 3.6 8 8 0 1.2-.3 2.4-.8 3.5l2.3 2.3C22.9 22.3 19.9 23.5 16 23.5c-5.5 0-10-4.5-10-10 0-3.3 1.1-6.3 3-8.5l2.3 2.3C13.6 8.3 14.8 8 16 8z" fill="#fff"/>
      </svg>
    </a>
    <a href="https://t.me/freebetslotgokil" target="_blank" class="corner-icon" title="Telegram">
      <!-- Telegram SVG -->
      <svg width="26" height="26" viewBox="0 0 32 32" fill="none">
        <circle cx="16" cy="16" r="16" fill="#0088cc"/>
        <path d="M24.7 9.3c-.2-.2-.5-.2-.7-.1l-15 6c-.3.1-.5.4-.5.7s.2.6.5.7l3.7 1.2 1.2 3.7c.1.3.4.5.7.5.1 0 .2 0 .3-.1l6-15c.1-.2.1-.5-.1-.7zm-7.2 12.1-1-3.1 7.1-7.1-6.1 10.2zm-2.1-2.1-3.1-1 10.2-6.1-7.1 7.1z" fill="#fff"/>
      </svg>
    </a>
  </div>
  <div class="main-center">
    <!-- Step 1: Form -->
    <form class="form-panel" id="formPanel" autocomplete="off">
      <div class="form-title">MYSTERY BOX SLOTGOKIL</div>
      <div class="form-group">
        <label class="form-label" for="userId">User ID</label>
        <input class="form-input" id="userId" name="userId" type="text" placeholder="Masukkan User ID" required maxlength="32" autocomplete="off">
      </div>
      <div class="form-group">
        <label class="form-label" for="kupon">Kode Kupon</label>
        <input class="form-input" id="kupon" name="kupon" type="text" placeholder="Masukkan Kode Kupon" required maxlength="32" autocomplete="off">
      </div>
      <button type="submit" class="btn-main">LANJUTKAN</button>
    </form>
    <!-- Step 2: Game -->
    <div class="game-panel" id="gamePanel" style="display:none;">
      <button class="prize-list-btn" id="btnPrizeList">游꾸 Lihat Daftar Hadiah</button>
      <div class="grid" id="boxGrid"></div>
      <button class="btn-show-history" id="btnShowHistory">Tampilkan History</button>
    </div>
  </div>
  <!-- Prize Modal -->
  <div class="modal-bg" id="modalPrizeList" style="display:none;">
    <div class="modal">
      <div class="modal-title">Daftar Hadiah Mystery Box</div>
      <table class="modal-table">
        <thead>
          <tr>
            <th>Hadiah</th>
            <th>Label</th>
          </tr>
        </thead>
        <tbody>
          <tr><td class="prize-amount">Rp 1.000.000</td><td class="prize-label">JACKPOT</td></tr>
          <tr><td class="prize-amount">Rp 500.000</td><td class="prize-label">MEGA PRIZE</td></tr>
          <tr><td class="prize-amount">Rp 10.000</td><td class="prize-label">SUPER</td></tr>
          <tr><td class="prize-amount">Rp 9.000</td><td class="prize-label">SUPER</td></tr>
          <tr><td class="prize-amount">Rp 8.000</td><td class="prize-label">RARE</td></tr>
          <tr><td class="prize-amount">Rp 7.000</td><td class="prize-label">RARE</td></tr>
          <tr><td class="prize-amount">Rp 6.000</td><td class="prize-label">REGULAR</td></tr>
          <tr><td class="prize-amount">Rp 5.000</td><td class="prize-label">REGULAR</td></tr>
          <tr><td class="prize-amount">Rp 4.000</td><td class="prize-label">REGULAR</td></tr>
          <tr><td class="prize-amount">Rp 3.000</td><td class="prize-label">REGULAR</td></tr>
          <tr><td class="prize-amount">Rp 2.000</td><td class="prize-label">REGULAR</td></tr>
          <tr><td class="prize-amount">Rp 1.000</td><td class="prize-label">REGULAR</td></tr>
        </tbody>
      </table>
      <button class="btn-close-modal" id="btnCloseModal">Tutup</button>
    </div>
  </div>
  <!-- Win Popup -->
  <div class="win-popup-bg" id="winPopup" style="display:none;">
    <div class="win-popup">
      <div class="prize-icon" id="winPrizeIcon"></div>
      <div class="win-title" id="winTitle">游댠 Kamu MENANG! 游꾸</div>
      <div class="win-prize" id="winPrizeText"></div>
      <a href="https://t.me/freebetslotgokil" target="_blank" class="btn-claim">CLAIM SEKARANG</a>
    </div>
  </div>
  <!-- Modal History -->
  <div class="modal-history-bg" id="modalHistory" style="display:none;">
    <div class="modal-history">
      <div class="modal-history-title">History Hasil Mystery Box</div>
      <div class="modal-history-row"><span class="modal-history-label">Tanggal</span><span class="modal-history-value" id="historyTanggal"></span></div>
      <div class="modal-history-row"><span class="modal-history-label">User ID</span><span class="modal-history-value" id="historyUser"></span></div>
      <div class="modal-history-row"><span class="modal-history-label">Kode Kupon</span><span class="modal-history-value" id="historyKupon"></span></div>
      <div class="modal-history-row"><span class="modal-history-label">Hasil</span><span class="modal-history-value">Menang<span class="modal-history-prize" id="historyPrize"></span></span></div>
      <button class="btn-close-history" id="btnCloseHistory">Tutup</button>
    </div>
  </div>
  <script>
    // Floating particles
    for(let i=0;i<12;i++){
      const p=document.createElement('div');
      p.className='particle';
      p.style.width=p.style.height=(Math.random()*12+8)+'px';
      p.style.left=(Math.random()*100)+'vw';
      p.style.top=(Math.random()*100)+'vh';
      p.style.background=`radial-gradient(circle, #${['ffd700','00e6a0','fffbe6'][Math.floor(Math.random()*3)]} 0%, transparent 80%)`;
      p.style.animationDuration=(Math.random()*8+8)+'s';
      p.style.opacity=Math.random()*0.2+0.12;
      document.body.appendChild(p);
    }
// Prize data (final only 2k-5k)
    // Daftar hadiah sesuai modal
    const daftarHadiah = [
      { amount: 1000000, label: 'SUPER', icon: `<svg class="prize-icon" viewBox="0 0 44 44"><ellipse cx="22" cy="34" rx="12" ry="6" fill="#fffbe6" opacity="0.18"/><ellipse cx="22" cy="22" rx="15" ry="15" fill="#ffd700" stroke="#00e6a0" stroke-width="2"/><ellipse cx="22" cy="22" rx="10" ry="10" fill="#fffbe6" stroke="#ffd700" stroke-width="2"/></svg>` },
      { amount: 500000, label: 'SUPER', icon: `<svg class="prize-icon" viewBox="0 0 44 44"><ellipse cx="22" cy="34" rx="12" ry="6" fill="#fffbe6" opacity="0.18"/><rect x="12" y="16" width="20" height="14" rx="6" fill="#ffd700" stroke="#00e6a0" stroke-width="2"/><ellipse cx="22" cy="16" rx="10" ry="6" fill="#fffbe6" stroke="#ffd700" stroke-width="1.2"/></svg>` },
      { amount: 8000, label: 'RARE', icon: `<svg class="prize-icon" viewBox="0 0 44 44"><polygon points="22,6 38,22 22,38 6,22" fill="#ffd700" stroke="#00e6a0" stroke-width="2"/><polygon points="22,12 34,22 22,34 10,22" fill="#fffbe6" stroke="#ffd700" stroke-width="1.2"/></svg>` },
      { amount: 7000, label: 'RARE', icon: `<svg class="prize-icon" viewBox="0 0 44 44"><ellipse cx="22" cy="34" rx="12" ry="6" fill="#fffbe6" opacity="0.18"/><ellipse cx="22" cy="22" rx="10" ry="10" fill="#ffd700" stroke="#00e6a0" stroke-width="2"/><ellipse cx="22" cy="22" rx="6" ry="6" fill="#fffbe6" stroke="#ffd700" stroke-width="1.2"/></svg>` },
      { amount: 6000, label: 'REGULAR', icon: `<svg class="prize-icon" viewBox="0 0 44 44"><ellipse cx="22" cy="34" rx="12" ry="6" fill="#fffbe6" opacity="0.18"/><rect x="12" y="16" width="20" height="14" rx="6" fill="#ffd700" stroke="#00e6a0" stroke-width="2"/><ellipse cx="22" cy="16" rx="10" ry="6" fill="#fffbe6" stroke="#ffd700" stroke-width="1.2"/></svg>` },
      { amount: 5000, label: 'REGULAR', icon: `<svg class="prize-icon" viewBox="0 0 44 44"><polygon points="22,6 38,22 22,38 6,22" fill="#ffd700" stroke="#00e6a0" stroke-width="2"/><polygon points="22,12 34,22 22,34 10,22" fill="#fffbe6" stroke="#ffd700" stroke-width="1.2"/></svg>` },
      { amount: 4000, label: 'REGULAR', icon: `<svg class="prize-icon" viewBox="0 0 44 44"><ellipse cx="22" cy="34" rx="12" ry="6" fill="#fffbe6" opacity="0.18"/><rect x="12" y="16" width="20" height="14" rx="6" fill="#ffd700" stroke="#00e6a0" stroke-width="2"/><ellipse cx="22" cy="16" rx="10" ry="6" fill="#fffbe6" stroke="#ffd700" stroke-width="1.2"/></svg>` },
      { amount: 3000, label: 'REGULAR', icon: `<svg class="prize-icon" viewBox="0 0 44 44"><ellipse cx="22" cy="34" rx="12" ry="6" fill="#fffbe6" opacity="0.18"/><rect x="12" y="16" width="20" height="14" rx="6" fill="#ffd700" stroke="#00e6a0" stroke-width="2"/><ellipse cx="22" cy="16" rx="10" ry="6" fill="#fffbe6" stroke="#ffd700" stroke-width="1.2"/></svg>` },
      { amount: 2000, label: 'REGULAR', icon: `<svg class="prize-icon" viewBox="0 0 44 44"><ellipse cx="22" cy="34" rx="12" ry="6" fill="#fffbe6" opacity="0.18"/><rect x="12" y="16" width="20" height="14" rx="6" fill="#ffd700" stroke="#00e6a0" stroke-width="2"/><ellipse cx="22" cy="16" rx="10" ry="6" fill="#fffbe6" stroke="#ffd700" stroke-width="1.2"/></svg>` },
      { amount: 1000, label: 'REGULAR', icon: `<svg class="prize-icon" viewBox="0 0 44 44"><polygon points="22,6 38,22 22,38 6,22" fill="#ffd700" stroke="#00e6a0" stroke-width="2"/><polygon points="22,12 34,22 22,34 10,22" fill="#fffbe6" stroke="#ffd700" stroke-width="1.2"/></svg>` }
    ];
// Gift box icon (before open)
    const mysteryIcon = `<svg class="mystery-icon" viewBox="0 0 44 44"><rect x="8" y="18" width="28" height="18" rx="6" fill="#ffd700" stroke="#00e6a0" stroke-width="2"/><rect x="14" y="8" width="16" height="10" rx="5" fill="#fffbe6" stroke="#ffd700" stroke-width="1.2"/><rect x="20" y="8" width="4" height="28" rx="2" fill="#00e6a0"/><ellipse cx="22" cy="38" rx="10" ry="3" fill="#fffbe6" opacity="0.18"/></svg>`;
    // Step 1: Form
    const formPanel = document.getElementById('formPanel');
    const gamePanel = document.getElementById('gamePanel');
    const boxGrid = document.getElementById('boxGrid');
    const winPopup = document.getElementById('winPopup');
    const winPrizeText = document.getElementById('winPrizeText');
    const winTitle = document.getElementById('winTitle');
    const winPrizeIcon = document.getElementById('winPrizeIcon');
    const btnShowHistory = document.getElementById('btnShowHistory');
    const modalHistory = document.getElementById('modalHistory');
    const historyTanggal = document.getElementById('historyTanggal');
    const historyUser = document.getElementById('historyUser');
    const historyKupon = document.getElementById('historyKupon');
    const historyPrize = document.getElementById('historyPrize');
    let boxClicked = false;
    let shuffledPrizes = [];
    let lastResult = null;
        // Form validation & transition + Google Apps Script integration
    formPanel.addEventListener('submit', async function(e){
      e.preventDefault();
      const userId = document.getElementById('userId').value.trim();
      const kupon = document.getElementById('kupon').value.trim();
      if(userId.length < 3 || kupon.length < 3){
        alert('User ID dan Kode Kupon minimal 3 karakter.');
        return;
      }
      // Reset state agar grid bisa diklik setelah submit baru
      boxClicked = false;
      lastResult = null;
      
      const url = 'https://script.google.com/macros/s/AKfycbx8JXXimlZFzYezsZoJ0swkjXtPs948LFetnV-XFVDfWgvkB4z6QObaxbkjJ69F8yAdWA/exec'
        + '?userId=' + encodeURIComponent(userId)
        + '&kupon=' + encodeURIComponent(kupon);

      try {
        const res = await fetch(url);
        const text = await res.text();

        if (text.includes("Selamat")) {
          // Simpan hadiah yang didapat dari server
          const hadiahMatch = text.match(/Rp\s*([\d,.]+)/);
          if (hadiahMatch) {
            const hadiahAmount = parseInt(hadiahMatch[1].replace(/[,.]/g, ''));
            const hadiahObj = daftarHadiah.find(h => h.amount === hadiahAmount) || daftarHadiah[5]; // default ke 5000
            window.hadiahUtamaResult = hadiahObj;
          } else {
            // Fallback jika tidak ada match
            window.hadiahUtamaResult = daftarHadiah[5]; // default ke 5000
          }
          
          formPanel.style.display = 'none';
          setTimeout(()=>{
            gamePanel.style.display = '';
            renderGrid();
          }, 200);
        } else {
          alert(text);
        }
      } catch (err) {
        alert('Gagal terhubung ke server. Coba lagi.');
      }
    });
        // Step 2: Render grid
    function shuffle(arr) {
      for (let i = arr.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [arr[i], arr[j]] = [arr[j], arr[i]];
      }
      return arr;
    }
    const zonkIcon = `<svg class="prize-icon" viewBox="0 0 44 44"><circle cx="22" cy="22" r="18" fill="#232a3a" stroke="#ffd700" stroke-width="2"/><ellipse cx="15" cy="18" rx="3" ry="4" fill="#fff"/><ellipse cx="29" cy="18" rx="3" ry="4" fill="#fff"/><circle cx="15" cy="19" r="1.2" fill="#232a3a"/><circle cx="29" cy="19" r="1.2" fill="#232a3a"/><path d="M16 28 Q22 34 28 28" stroke="#fff" stroke-width="2" fill="none"/><rect x="18" y="34" width="8" height="4" rx="2" fill="#ffd700"/></svg>`;
    function renderGrid(){
      boxGrid.innerHTML = '';
      // Hadiah utama: gunakan hasil submit (sinkron dengan Google Sheet)
      const hadiahUtama = window.hadiahUtamaResult;
      
      // Hadiah gimick besar untuk tampilan di box lain (HANYA VISUAL)
      const hadiahGimick = [
        { amount: 1000000, label: 'JACKPOT', icon: `<svg class="prize-icon" viewBox="0 0 44 44"><ellipse cx="22" cy="34" rx="12" ry="6" fill="#fffbe6" opacity="0.18"/><ellipse cx="22" cy="22" rx="18" ry="18" fill="#ffd700" stroke="#00e6a0" stroke-width="3"/><ellipse cx="22" cy="22" rx="12" ry="12" fill="#fffbe6" stroke="#ffd700" stroke-width="2"/><circle cx="22" cy="22" r="6" fill="#ffd700"/></svg>` },
        { amount: 500000, label: 'MEGA PRIZE', icon: `<svg class="prize-icon" viewBox="0 0 44 44"><ellipse cx="22" cy="34" rx="12" ry="6" fill="#fffbe6" opacity="0.18"/><ellipse cx="22" cy="22" rx="16" ry="16" fill="#ffd700" stroke="#00e6a0" stroke-width="2"/><ellipse cx="22" cy="22" rx="11" ry="11" fill="#fffbe6" stroke="#ffd700" stroke-width="2"/><circle cx="22" cy="22" r="5" fill="#ffd700"/></svg>` }
      ];
      
      // Hadiah lain: campuran semua hadiah 3K-10K dan gimick untuk tampilan
      let hadiahLain = [...daftarHadiah.filter(h => h.amount !== hadiahUtama.amount), ...hadiahGimick];
      
      // Pastikan semua hadiah 3K-10K ada di grid (duplikasi jika perlu)
      const semuaHadiah = [...daftarHadiah];
      while (hadiahLain.length < 8) {
        hadiahLain = hadiahLain.concat(semuaHadiah.filter(h => h.amount !== hadiahUtama.amount));
      }
      hadiahLain = hadiahLain.slice(0,8);
      
      // Acak posisi grid
      const posisiAcak = Array.from({length: 9}, (_, i) => i);
      for (let i = posisiAcak.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [posisiAcak[i], posisiAcak[j]] = [posisiAcak[j], posisiAcak[i]];
      }
      // shuffledPrizes: hadiah utama di posisi yang akan dipilih user (nanti di openBox), hadiah lain di posisi lain
      shuffledPrizes = Array(9).fill(null);
      let idxLain = 0;
      for (let i = 0; i < 9; i++) {
        shuffledPrizes[posisiAcak[i]] = idxLain < 8 ? hadiahLain[idxLain] : null;
        idxLain++;
      }
      shuffledPrizes.hadiahUtama = hadiahUtama;
for(let i=0;i<9;i++){
        const box = document.createElement('div');
        box.className = 'box';
        box.tabIndex = 0;
        box.setAttribute('aria-label', 'Mystery Box');
        box.innerHTML = mysteryIcon;
        box.addEventListener('click', ()=>openBox(box, i));
        box.addEventListener('keydown', (e)=>{if(e.key==='Enter'||e.key===' '){openBox(box,i)}});
        boxGrid.appendChild(box);
      }
      boxClicked = false;
      btnShowHistory.classList.remove('active');
    }
    // Open box
function openBox(box, idx){
  if(boxClicked) return;
  boxClicked = true;
  // Hadiah utama SELALU di box yang dipilih, fix 3k/4k/5k
  shuffledPrizes[idx] = shuffledPrizes.hadiahUtama;
  // Animate shine
  const shine = document.createElement('div');
  shine.className = 'shine';
  box.appendChild(shine);
  // Burst effect
  const burst = document.createElement('div');
  burst.className = 'burst';
  burst.innerHTML = `<svg width="70" height="70" viewBox="0 0 70 70" fill="none">
    <g>
      <circle cx="35" cy="35" r="10" fill="#ffd700" opacity="0.7"/>
      <circle cx="35" cy="10" r="2" fill="#fffbe6"/>
      <circle cx="35" cy="60" r="2" fill="#fffbe6"/>
      <circle cx="10" cy="35" r="2" fill="#fffbe6"/>
      <circle cx="60" cy="35" r="2" fill="#fffbe6"/>
      <circle cx="20" cy="20" r="1.5" fill="#ffd700"/>
      <circle cx="50" cy="20" r="1.5" fill="#ffd700"/>
      <circle cx="20" cy="50" r="1.5" fill="#ffd700"/>
      <circle cx="50" cy="50" r="1.5" fill="#ffd700"/>
    </g>
  </svg>`;
  box.appendChild(burst);
  setTimeout(()=>{
    // Buka box yang diklik dulu (hadiah utama)
    box.innerHTML = `<div class='mystery-icon'></div><div class='prize-icon'></div><div class='prize-amount-text'></div>`;
    box.classList.add('opened');
    box.classList.add('disabled');
    box.classList.add('selected');
    box.tabIndex = -1;
    box.querySelector('.prize-icon').innerHTML = shuffledPrizes[idx].icon;
    box.querySelector('.mystery-icon').innerHTML = mysteryIcon;
    box.querySelector('.prize-amount-text').innerHTML = `<span style='font-size:1.35rem;font-weight:900;color:#fffbe6;text-shadow:0 0 10px #ffd700,0 0 4px #00e6a0;'>Rp ${shuffledPrizes[idx].amount.toLocaleString('id-ID')}</span>`;
    // Animasi buka box lain satu per satu
    const allBoxes = Array.from(document.querySelectorAll('.box'));
    let delay = 0;
    for(let i=0;i<allBoxes.length;i++){
      if(i===idx) continue;
      delay += 150;
      setTimeout(()=>{
            const b = allBoxes[i];
            b.innerHTML = `<div class='mystery-icon'></div><div class='prize-icon'></div><div class='prize-amount-text'></div>`;
            b.classList.add('opened');
            b.classList.add('disabled');
            b.tabIndex = -1;
            if(shuffledPrizes[i]){
              b.querySelector('.prize-icon').innerHTML = shuffledPrizes[i].icon;
              b.querySelector('.prize-amount-text').innerHTML = `<span style='font-size:1.15rem;font-weight:900;color:#fffbe6;text-shadow:0 0 8px #ffd700,0 0 2px #00e6a0;'>Rp ${shuffledPrizes[i].amount.toLocaleString('id-ID')}</span>`;
            }else{
              b.querySelector('.prize-icon').innerHTML = zonkIcon;
              b.querySelector('.prize-amount-text').innerHTML = `<span style='font-size:1.15rem;font-weight:900;color:#ffd700,text-shadow:0 0 8px #ffd700,0 0 2px #232a3a;'>ZONK</span>`;
            }
            b.querySelector('.mystery-icon').innerHTML = mysteryIcon;
            b.classList.remove('selected');
            // Animasi shine dan burst untuk setiap box
            const shine = document.createElement('div');
            shine.className = 'shine';
            b.appendChild(shine);
            const burst = document.createElement('div');
            burst.className = 'burst';
            burst.innerHTML = `<svg width="70" height="70" viewBox="0 0 70 70" fill="none">
              <g>
                <circle cx="35" cy="35" r="10" fill="#ffd700" opacity="0.7"/>
                <circle cx="35" cy="10" r="2" fill="#fffbe6"/>
                <circle cx="35" cy="60" r="2" fill="#fffbe6"/>
                <circle cx="10" cy="35" r="2" fill="#fffbe6"/>
                <circle cx="60" cy="35" r="2" fill="#fffbe6"/>
                <circle cx="20" cy="20" r="1.5" fill="#ffd700"/>
                <circle cx="50" cy="20" r="1.5" fill="#ffd700"/>
                <circle cx="20" cy="50" r="1.5" fill="#ffd700"/>
                <circle cx="50" cy="50" r="1.5" fill="#ffd700"/>
              </g>
            </svg>`;
            b.appendChild(burst);
            setTimeout(()=>{
              const burstSVG = b.querySelector('.burst');
              if(burstSVG) burstSVG.remove();
            }, 700);
      }, delay);
    }
    // Box yang diklik tetap menampilkan hadiah utama di win popup
    setTimeout(()=>{
      showWinPopup(shuffledPrizes[idx]);
      btnShowHistory.classList.add('active');
      lastResult = shuffledPrizes[idx];
    }, delay+400);
  }, 600);
}
                  // Show win popup (default)
    function showWinPopup(prize){
      winPrizeText.textContent = `Hadiah: Rp ${prize.amount.toLocaleString('id-ID')}`;
      winTitle.innerHTML = `游댠 Kamu MENANG! 游꾸`;
      winPopup.style.display = 'flex';
      winPrizeIcon.innerHTML = getExplosionSVG() + prize.icon;
      animateExplosion();
    }

    // Show win popup dari Google Apps Script
    function showWinPopupFromGS(message){
      winPrizeText.textContent = message;
      winTitle.innerHTML = `游댠 Kamu MENANG! 游꾸`;
      winPopup.style.display = 'flex';
      winPrizeIcon.innerHTML = getExplosionSVG();
      animateExplosion();
    }

    // SVG ledakan keren
    function getExplosionSVG() {
      return `
        <svg id="explosionSVG" width="90" height="90" viewBox="0 0 90 90" style="position:absolute;left:50%;top:50%;transform:translate(-50%,-50%);pointer-events:none;z-index:100;">
          <g>
            <circle cx="45" cy="45" r="18" fill="#ffd700" opacity="0.7">
              <animate attributeName="r" from="0" to="38" dur="0.5s" fill="freeze"/>
              <animate attributeName="opacity" from="1" to="0" dur="0.7s" fill="freeze"/>
            </circle>
            <circle cx="45" cy="15" r="5" fill="#fffbe6">
              <animate attributeName="r" from="0" to="12" dur="0.5s" fill="freeze"/>
              <animate attributeName="opacity" from="1" to="0" dur="0.7s" fill="freeze"/>
            </circle>
            <circle cx="45" cy="75" r="5" fill="#fffbe6">
              <animate attributeName="r" from="0" to="12" dur="0.5s" fill="freeze"/>
              <animate attributeName="opacity" from="1" to="0" dur="0.7s" fill="freeze"/>
            </circle>
            <circle cx="15" cy="45" r="5" fill="#fffbe6">
              <animate attributeName="r" from="0" to="12" dur="0.5s" fill="freeze"/>
              <animate attributeName="opacity" from="1" to="0" dur="0.7s" fill="freeze"/>
            </circle>
            <circle cx="75" cy="45" r="5" fill="#fffbe6">
              <animate attributeName="r" from="0" to="12" dur="0.5s" fill="freeze"/>
              <animate attributeName="opacity" from="1" to="0" dur="0.7s" fill="freeze"/>
            </circle>
            <circle cx="25" cy="25" r="3.5" fill="#ffd700">
              <animate attributeName="r" from="0" to="8" dur="0.5s" fill="freeze"/>
              <animate attributeName="opacity" from="1" to="0" dur="0.7s" fill="freeze"/>
            </circle>
            <circle cx="65" cy="25" r="3.5" fill="#ffd700">
              <animate attributeName="r" from="0" to="8" dur="0.5s" fill="freeze"/>
              <animate attributeName="opacity" from="1" to="0" dur="0.7s" fill="freeze"/>
            </circle>
            <circle cx="25" cy="65" r="3.5" fill="#ffd700">
              <animate attributeName="r" from="0" to="8" dur="0.5s" fill="freeze"/>
              <animate attributeName="opacity" from="1" to "0" dur="0.7s" fill="freeze"/>
            </circle>
            <circle cx="65" cy="65" r="3.5" fill="#ffd700">
              <animate attributeName="r" from="0" to="8" dur="0.5s" fill="freeze"/>
              <animate attributeName="opacity" from="1" to="0" dur="0.7s" fill="freeze"/>
            </circle>
          </g>
        </svg>
      `;
    }

    // Optional: Remove SVG after animation
    function animateExplosion() {
      setTimeout(()=>{
        const svg = document.getElementById('explosionSVG');
        if(svg) svg.remove();
      }, 800);
    }
    // Close win popup on outside click
    winPopup.addEventListener('click', function(e){
      if(e.target===winPopup) winPopup.style.display='none';
    });
    // Prize list modal
    const modalPrizeList = document.getElementById('modalPrizeList');
    document.getElementById('btnPrizeList').onclick = ()=>{modalPrizeList.style.display='flex';};
    document.getElementById('btnCloseModal').onclick = ()=>{modalPrizeList.style.display='none';};
    modalPrizeList.addEventListener('click', function(e){
      if(e.target===modalPrizeList) modalPrizeList.style.display='none';
    });
    // Accessibility: close modal with Esc
    document.addEventListener('keydown', function(e){
      if(e.key==='Escape'){
        if(modalPrizeList.style.display==='flex') modalPrizeList.style.display='none';
        if(winPopup.style.display==='flex') winPopup.style.display='none';
        if(modalHistory.style.display==='flex') modalHistory.style.display='none';
      }
    });
    // Modal History
    btnShowHistory.onclick = function(){
      if(!lastResult) return;
      const userId = document.getElementById('userId').value.trim();
      const kupon = document.getElementById('kupon').value.trim();
      const now = new Date();
      const tanggal = now.toLocaleDateString('id-ID');
      historyTanggal.textContent = tanggal;
      historyUser.textContent = userId;
      historyKupon.textContent = kupon;
      historyPrize.textContent = `Rp ${lastResult.amount.toLocaleString('id-ID')}`;
      modalHistory.style.display = 'flex';
    }
    document.getElementById('btnCloseHistory').onclick = ()=>{modalHistory.style.display='none';};
    modalHistory.addEventListener('click', function(e){
      if(e.target===modalHistory) modalHistory.style.display='none';
    });
  </script>
</body>
</html>
